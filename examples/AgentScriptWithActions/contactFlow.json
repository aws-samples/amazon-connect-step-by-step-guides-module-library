{
    "Version": "2019-10-30",
    "StartAction": "9118e2fb-c62f-4c29-9eff-e93da91cac29",
    "Metadata": {
        "entryPointPosition": { "x": -358.4, "y": -72.8 },
        "ActionMetadata": {
            "9118e2fb-c62f-4c29-9eff-e93da91cac29": { "position": { "x": -104.8, "y": -47.2 } },
            "61f4731f-eabe-4d1d-835c-a35956299244": { "position": { "x": 443.2, "y": 868 } },
            "35f6935a-b3f2-4b29-90f2-6cd2998da07b": {
                "position": { "x": -105.6, "y": 141.6 },
                "useDynamic": {},
                "customerProfilesAction": "GetCustomerProfile"
            },
            "09e52458-e5f0-44e2-b792-f91357219202": {
                "position": { "x": -100, "y": 417.6 },
                "useDynamic": {},
                "customerProfilesAction": "CreateCustomerProfile"
            },
            "032fdba4-bfbd-44b0-9cc4-137dbe7716cd": { "position": { "x": 180.8, "y": 324.8 }, "dynamicParams": [] },
            "31aa4fee-6480-495e-b003-bbf5b4ab1cea": { "position": { "x": 1730.4, "y": 190.4 } },
            "dde23aa2-75f5-4d02-b08c-14f44fa43b4d": { "position": { "x": 739.2, "y": 131.2 }, "dynamicParams": [] },
            "2c383a61-44af-4cac-90e3-e68383c807e5": {
                "position": { "x": 1064, "y": 129.6 },
                "parameters": {
                    "ViewResource": { "Id": { "displayName": "Form View" } },
                    "InvocationTimeLimitSeconds": { "unit": 60 },
                    "ViewData": { "AttributeBar": { "useJson": true }, "Back": { "useJson": true } }
                }
            },
            "1d7356ff-54b4-4293-9204-b19c2b39c7e4": {
                "position": { "x": 1588, "y": 758.4 },
                "parameters": {
                    "ViewResource": { "Id": { "displayName": "Confirmation" } },
                    "InvocationTimeLimitSeconds": { "unit": 1 },
                    "ViewData": { "AttributeBar": { "useJson": true } }
                }
            },
            "3120fc9e-79ba-4509-b037-9a4367d7103f": {
                "position": { "x": 1326.4, "y": 468 },
                "parameters": { "LambdaFunctionARN": { "displayName": "" } },
                "dynamicMetadata": { "destination": false, "formData": false }
            },
            "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7": {
                "position": { "x": 482.4, "y": 18.4 },
                "parameters": {
                    "ViewResource": { "Id": { "displayName": "Cards" } },
                    "InvocationTimeLimitSeconds": { "unit": 60 },
                    "ViewData": {
                        "AttributeBar": { "useJson": true },
                        "Back": { "useJson": true },
                        "NoMatchFound": { "useJson": true },
                        "Cards": { "useJson": true }
                    }
                }
            },
            "11e0ea4b-5502-4849-b966-b0dc6d6ad789": { "position": { "x": 2164.8, "y": 732 } },
            "58c1a435-ead8-49eb-b38e-35a05640952d": {
                "position": { "x": 1583.2, "y": 472.8 },
                "parameters": { "LambdaFunctionARN": { "displayName": "" } },
                "dynamicMetadata": { "formData": false, "systemEmail": false, "destinationEmail": false }
            },
            "fbb706b1-674c-422c-9859-b78dff7de155": {
                "position": { "x": 1838.4, "y": 468 },
                "parameters": {
                    "ViewResource": { "Id": { "displayName": "Confirmation" } },
                    "InvocationTimeLimitSeconds": { "unit": 1 },
                    "ViewData": { "AttributeBar": { "useJson": true } }
                }
            }
        },
        "name": "Demo - Views with SMS / Email",
        "description": "",
        "type": "contactFlow",
        "status": "published",
        "hash": {}
    },
    "Actions": [
        {
            "Parameters": { "FlowLoggingBehavior": "Enabled" },
            "Identifier": "9118e2fb-c62f-4c29-9eff-e93da91cac29",
            "Type": "UpdateFlowLoggingBehavior",
            "Transitions": { "NextAction": "35f6935a-b3f2-4b29-90f2-6cd2998da07b" }
        },
        {
            "Parameters": {},
            "Identifier": "61f4731f-eabe-4d1d-835c-a35956299244",
            "Type": "DisconnectParticipant",
            "Transitions": {}
        },
        {
            "Parameters": {
                "ProfileRequestData": { "PhoneNumber": "+642108895745" },
                "ProfileResponseData": [
                    "FirstName",
                    "LastName",
                    "PhoneNumber",
                    "EmailAddress",
                    "Address1",
                    "City",
                    "Country",
                    "PostalCode",
                    "State"
                ]
            },
            "Identifier": "35f6935a-b3f2-4b29-90f2-6cd2998da07b",
            "Type": "GetCustomerProfile",
            "Transitions": {
                "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd",
                "Errors": [
                    { "NextAction": "09e52458-e5f0-44e2-b792-f91357219202", "ErrorType": "NoMatchingError" },
                    { "NextAction": "09e52458-e5f0-44e2-b792-f91357219202", "ErrorType": "MultipleFoundError" },
                    { "NextAction": "09e52458-e5f0-44e2-b792-f91357219202", "ErrorType": "NoneFoundError" }
                ]
            }
        },
        {
            "Parameters": {
                "ProfileRequestData": { "FirstName": "Sample", "LastName": "Customer", "PhoneNumber": "+11111111111" },
                "ProfileResponseData": ["FirstName", "LastName", "PhoneNumber"]
            },
            "Identifier": "09e52458-e5f0-44e2-b792-f91357219202",
            "Type": "CreateCustomerProfile",
            "Transitions": {
                "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd",
                "Errors": [{ "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd", "ErrorType": "NoMatchingError" }]
            }
        },
        {
            "Parameters": {
                "Attributes": {
                    "CustomerFullName": "$.Customer.FirstName $.Customer.LastName",
                    "callType": "Cards with actions"
                }
            },
            "Identifier": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd",
            "Type": "UpdateContactAttributes",
            "Transitions": {
                "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
                "Errors": [{ "NextAction": "61f4731f-eabe-4d1d-835c-a35956299244", "ErrorType": "NoMatchingError" }]
            }
        },
        {
            "Parameters": {},
            "Identifier": "31aa4fee-6480-495e-b003-bbf5b4ab1cea",
            "Type": "DisconnectParticipant",
            "Transitions": {}
        },
        {
            "Parameters": { "Attributes": { "actionName": "$.Views.ViewResultData.actionName" } },
            "Identifier": "dde23aa2-75f5-4d02-b08c-14f44fa43b4d",
            "Type": "UpdateContactAttributes",
            "Transitions": {
                "NextAction": "2c383a61-44af-4cac-90e3-e68383c807e5",
                "Errors": [{ "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd", "ErrorType": "NoMatchingError" }]
            }
        },
        {
            "Parameters": {
                "ViewResource": { "Id": "formWithSteps", "Version": "Latest" },
                "InvocationTimeLimitSeconds": "18000",
                "ViewData": {
                    "Heading": "\"$.Attributes.actionName\"",
                    "AttributeBar": [
                        { "Label": "Call", "Value": "$.Attributes.callType" },
                        {
                            "Label": "Link",
                            "Value": "External System",
                            "LinkType": "external",
                            "Url": "<link to an external website>"
                        }
                    ],
                    "Sections": "[     {         \"Heading\": \"Customer Information\",         \"Type\": \"DataSection\",         \"IsEditable\": false,         \"Configuration\":         {},         \"Items\":         [             {                 \"AutoOpen\": false,                 \"Label\": \"Customer Name\",                 \"Value\": \"$.Customer.FirstName $.Customer.LastName\",                 \"Copyable\": false             },             {                 \"AutoOpen\": false,                 \"Label\": \"Phone Number\",                 \"Value\": \"$.Customer.PhoneNumber\",                 \"Copyable\": false             },             {                 \"AutoOpen\": false,                 \"Label\": \"Email\",                 \"Value\": \"$.Customer.EmailAddress\",                 \"Copyable\": false             }         ]     },     {         \"Heading\": \"Details\",         \"Type\": \"FormSection\",         \"IsEditable\": false,         \"Configuration\":         {},         \"Items\":         [             {                 \"Type\": \"DatePicker\",                 \"Required\": false,                 \"Fluid\": true,                 \"Label\": \"Appointment date\",                 \"Name\": \"appt-day\",                 \"MultiSelect\": false             },             {                 \"Type\": \"TimePicker\",                 \"Required\": false,                 \"Fluid\": true,                 \"Label\": \"Time\",                 \"Name\": \"appt-time\",                 \"MultiSelect\": false             },             {                 \"Required\": false,                 \"Fluid\": false,                 \"MultiSelect\": false,                 \"Type\": \"TextArea\",                 \"Name\": \"message-details\",                 \"DefaultValue\": \"\",                 \"Label\": \"Message details\"             }         ]     } ]",
                    "Back": { "Label": "Back" }
                }
            },
            "Identifier": "2c383a61-44af-4cac-90e3-e68383c807e5",
            "Type": "ShowView",
            "Transitions": {
                "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea",
                "Conditions": [
                    {
                        "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
                        "Condition": { "Operator": "Equals", "Operands": ["Back"] }
                    },
                    {
                        "NextAction": "3120fc9e-79ba-4509-b037-9a4367d7103f",
                        "Condition": { "Operator": "Equals", "Operands": ["Next"] }
                    },
                    {
                        "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
                        "Condition": { "Operator": "Equals", "Operands": ["Step"] }
                    }
                ],
                "Errors": [
                    { "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea", "ErrorType": "NoMatchingCondition" },
                    { "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea", "ErrorType": "NoMatchingError" },
                    { "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7", "ErrorType": "TimeLimitExceeded" }
                ]
            }
        },
        {
            "Parameters": {
                "ViewResource": { "Id": "confirmation", "Version": "Latest" },
                "InvocationTimeLimitSeconds": "300",
                "ViewData": {
                    "Heading": "\"Message sent !\"",
                    "AttributeBar": [
                        { "Label": "Call", "Value": "$.Attributes.callType" },
                        {
                            "Label": "Link",
                            "Value": "External System",
                            "LinkType": "external",
                            "Url": "<link to an external website>"
                        }
                    ],
                    "Graphic": "{\"Include\": true}",
                    "Next": "{\"Label\":\"Close this workflow\"}",
                    "SubHeading": "You can now close this workflow."
                }
            },
            "Identifier": "1d7356ff-54b4-4293-9204-b19c2b39c7e4",
            "Type": "ShowView",
            "Transitions": {
                "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789",
                "Conditions": [
                    {
                        "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
                        "Condition": { "Operator": "Equals", "Operands": ["Next"] }
                    }
                ],
                "Errors": [
                    { "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789", "ErrorType": "NoMatchingCondition" },
                    { "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789", "ErrorType": "NoMatchingError" },
                    { "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7", "ErrorType": "TimeLimitExceeded" }
                ]
            }
        },
        {
            "Parameters": {
                "LambdaFunctionARN": "<replace with your sendSMS Lambda function>",
                "InvocationTimeLimitSeconds": "6",
                "LambdaInvocationAttributes": {
                    "destination": "<phone number in e.164 format>",
                    "formData": "$.Views.ViewResultData.FormData"
                },
                "ResponseValidation": { "ResponseType": "STRING_MAP" }
            },
            "Identifier": "3120fc9e-79ba-4509-b037-9a4367d7103f",
            "Type": "InvokeLambdaFunction",
            "Transitions": {
                "NextAction": "58c1a435-ead8-49eb-b38e-35a05640952d",
                "Errors": [{ "NextAction": "1d7356ff-54b4-4293-9204-b19c2b39c7e4", "ErrorType": "NoMatchingError" }]
            }
        },
        {
            "Parameters": {
                "ViewResource": { "Id": "cards", "Version": "Latest" },
                "InvocationTimeLimitSeconds": "18000",
                "ViewData": {
                    "Heading": "\"A view with cards and actions\"",
                    "AttributeBar": [
                        { "Label": "Call", "Value": "$.Attributes.callType" },
                        {
                            "Label": "Link",
                            "Value": "External System",
                            "LinkType": "external",
                            "Url": "<link to an external website>"
                        }
                    ],
                    "Back": { "Label": "Back" },
                    "NoMatchFound": { "Label": "No match found ?" },
                    "Cards": [
                        {
                            "Summary": { "Id": "card1", "Icon": "Book Open", "Heading": "Card 1" },
                            "Detail": {
                                "Heading": "Card 1",
                                "Sections": [
                                    { "TemplateString": "<TextContent><p>See Card 2 for actions</p></TextContent>" }
                                ]
                            }
                        },
                        {
                            "Summary": { "Id": "card 2", "Icon": "Pencil Holder", "Heading": "Card 2" },
                            "Detail": {
                                "Heading": "Card 2",
                                "Sections": [
                                    {
                                        "TemplateString": "<TextContent>Clicking on either action will open a Form view.</TextContent>"
                                    }
                                ],
                                "Actions": ["Action 1", "Action 2"]
                            }
                        },
                        {
                            "Summary": { "Id": "card3", "Icon": "Chat", "Heading": "Card 3" },
                            "Detail": {
                                "Heading": "Card 3",
                                "Sections": [{ "TemplateString": "<TextContent>No details.</TextContent>" }]
                            }
                        },
                        {
                            "Summary": { "Id": "card4", "Icon": "Cash", "Heading": "Card 4" },
                            "Detail": {
                                "Heading": "Card 4",
                                "Sections": { "TemplateString": "<TextContent>No details.</TextContent>" }
                            }
                        }
                    ]
                }
            },
            "Identifier": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
            "Type": "ShowView",
            "Transitions": {
                "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea",
                "Conditions": [
                    {
                        "NextAction": "dde23aa2-75f5-4d02-b08c-14f44fa43b4d",
                        "Condition": { "Operator": "Equals", "Operands": ["ActionSelected"] }
                    },
                    {
                        "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd",
                        "Condition": { "Operator": "Equals", "Operands": ["Back"] }
                    },
                    {
                        "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd",
                        "Condition": { "Operator": "Equals", "Operands": ["NoMatchFound"] }
                    }
                ],
                "Errors": [
                    { "NextAction": "032fdba4-bfbd-44b0-9cc4-137dbe7716cd", "ErrorType": "NoMatchingCondition" },
                    { "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea", "ErrorType": "NoMatchingError" },
                    { "NextAction": "31aa4fee-6480-495e-b003-bbf5b4ab1cea", "ErrorType": "TimeLimitExceeded" }
                ]
            }
        },
        {
            "Parameters": {},
            "Identifier": "11e0ea4b-5502-4849-b966-b0dc6d6ad789",
            "Type": "DisconnectParticipant",
            "Transitions": {}
        },
        {
            "Parameters": {
                "LambdaFunctionARN": "<replace with your sendEmail Lambda function>",
                "InvocationTimeLimitSeconds": "6",
                "LambdaInvocationAttributes": {
                    "formData": "$.Views.ViewResultData.FormData",
                    "systemEmail": "<origin email address>",
                    "destinationEmail": "<destination email address>"
                },
                "ResponseValidation": { "ResponseType": "STRING_MAP" }
            },
            "Identifier": "58c1a435-ead8-49eb-b38e-35a05640952d",
            "Type": "InvokeLambdaFunction",
            "Transitions": {
                "NextAction": "fbb706b1-674c-422c-9859-b78dff7de155",
                "Errors": [{ "NextAction": "1d7356ff-54b4-4293-9204-b19c2b39c7e4", "ErrorType": "NoMatchingError" }]
            }
        },
        {
            "Parameters": {
                "ViewResource": { "Id": "confirmation", "Version": "Latest" },
                "InvocationTimeLimitSeconds": "5",
                "ViewData": {
                    "Heading": "\"Message sent !\"",
                    "AttributeBar": [
                        { "Label": "Call", "Value": "$.Attributes.callType" },
                        {
                            "Label": "Link",
                            "Value": "External System",
                            "LinkType": "external",
                            "Url": "<link to an external website>"
                        }
                    ],
                    "Graphic": "{\"Include\": true}",
                    "Next": "{\"Label\":\"Close this workflow\"}",
                    "SubHeading": "You can now close this workflow."
                }
            },
            "Identifier": "fbb706b1-674c-422c-9859-b78dff7de155",
            "Type": "ShowView",
            "Transitions": {
                "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789",
                "Conditions": [
                    {
                        "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7",
                        "Condition": { "Operator": "Equals", "Operands": ["Next"] }
                    }
                ],
                "Errors": [
                    { "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789", "ErrorType": "NoMatchingCondition" },
                    { "NextAction": "11e0ea4b-5502-4849-b966-b0dc6d6ad789", "ErrorType": "NoMatchingError" },
                    { "NextAction": "dffdf5f8-04f2-4880-a6dc-b18fbddf61f7", "ErrorType": "TimeLimitExceeded" }
                ]
            }
        }
    ]
}
